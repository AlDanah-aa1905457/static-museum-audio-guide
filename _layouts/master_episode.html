<!DOCTYPE html>
<html lang="en">

<head>
  {% include head.html %}
  <!-- Ensure jPlayer CSS is included -->
  <link rel="stylesheet" href="{{ site.baseurl }}/css/jplayer.blue.monday.css">
</head>

<body>
  {% include tagmanager.html %}
  {% include header-episode.html %}

  <div class="slide-menu">
    <h2>{{ site.menu_heading }}</h2>
    <ul class="post-list">
      {% assign pages = site.pages | sort: 'page_rank' %}
      {% for my_page in pages %}
        {% if (my_page.section_title_en != null) and my_page.type == 'stop' %}
          <li>
            <a class="post-link" href="{{ my_page.url | prepend: site.baseurl }}" style="background-image: url('{{ site.baseurl }}{{ site.headphones_icon_color }}');">
              <span class="post-item">{{ my_page.stop_id }}</span>
            </a>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  </div>

  <div class="page-content">
    <div class="wrapper">
      {{ content }}
    </div>
  </div>

  <div id="jp_container_1" class="jp-audio" role="application" aria-label="media player">
    <div class="jp-gui jp-interface audio-footer-container" data-role="footer" data-position="fixed" data-tap-toggle="false">
      <div class="audio-player">
        
        <div class="player-now-playing">
          <p id="audio-title-en" style="display: inline;">{{ page.title_en }}</p>
          <p id="audio-title-ar" style="display: none;">{{ page.title_ar }}</p>
          <button id="toggle-language" style="background: none; border: none; font-size: 20px; cursor: pointer; margin-left: 10px;" title="Toggle Language">üåê</button>
        </div>

        <div id="jquery_jplayer_1" class="jp-jplayer"></div>

        <div class="jp-progress">
          <div class="jp-seek-bar">
            <div class="jp-play-bar"></div>
          </div>
        </div>

        <div class="player-buttons">
          <div class="jp-controls" style="text-align: center;">
            <button class="jp-play" role="button" tabindex="0" style="display: inline-block;"></button>
            <button class="jp-pause" role="button" tabindex="0" style="display: none;"></button>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Ensure jQuery and jPlayer are loaded -->
  <script src="{{ site.baseurl }}/js/jquery.min.js"></script>
  <script src="{{ site.baseurl }}/js/jquery.jplayer.min.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const toggleButton = document.getElementById('toggle-language');
      const titleEn = document.getElementById('audio-title-en');
      const titleAr = document.getElementById('audio-title-ar');
      const jpPlayer = $('#jquery_jplayer_1');
      const audioPathEn = "{{ site.baseurl }}{{ site.audio_path }}{{ page.audio_file_en }}";
      const audioPathAr = "{{ site.baseurl }}{{ site.audio_path }}{{ page.audio_file_ar }}";

      let currentLanguage = 'en';

      // Initialize jPlayer with English audio by default
      jpPlayer.jPlayer({
        ready: function () {
          $(this).jPlayer("setMedia", { mp3: audioPathEn });
        },
        swfPath: "/js",
        supplied: "mp3",
        cssSelectorAncestor: "#jp_container_1",
      });

      // Toggle Language
      toggleButton.addEventListener('click', function() {
        currentLanguage = currentLanguage === 'en' ? 'ar' : 'en';
        const newAudioPath = currentLanguage === 'en' ? audioPathEn : audioPathAr;

        // Update Titles
        titleEn.style.display = currentLanguage === 'en' ? 'inline' : 'none';
        titleAr.style.display = currentLanguage === 'ar' ? 'inline' : 'none';

        // Set new audio source
        jpPlayer.jPlayer("setMedia", { mp3: newAudioPath }).jPlayer("play");
      });
    });
  </script>

</body>

</html>
